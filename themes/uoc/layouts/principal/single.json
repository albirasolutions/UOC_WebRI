{{ $.Scratch.Set "len" 0 }}
{{ range $i, $s := .Site.AllPages }}
	{{- if and ( or (eq $s.Type "solucio_tec") (eq $s.Type "patent") (eq $s.Type "servei") (eq $s.Type "spin_off") (eq $s.Type "noticies") (eq $s.Type "esdeveniments")) (ne $s.File.UniqueID "")}}
	{{ $.Scratch.Set "len" (add ($.Scratch.Get "len") 1) }}
	{{end}}
{{end}}
{{ $.Scratch.Set "counter" 0 }}
[{{ range $i, $s := .Site.AllPages }}{{- if and ( or (eq $s.Type "solucio_tec") (eq $s.Type "patent") (eq $s.Type "servei") (eq $s.Type "spin_off")) (ne $s.File.UniqueID "")}}{
	  {{ $.Scratch.Set "counter" (add ($.Scratch.Get "counter") 1) }}
		"type" : "add",
		"id" : {{ $s.File.UniqueID | jsonify }},
		"fields" : {
			
			
			{{with $s.Params.language}}"idioma": {{. | jsonify}},{{end}}
			{{with $s.Params.title}}"title": {{. | jsonify}},{{end}}
			

			{{if eq $s.Type "solucio_tec" }}
				{{with $s.Params.general.nom_solucio}}"name" : {{ . | jsonify}},{{end}}
			{{else if eq $s.Type "patent"}}
				{{with $s.Params.general.nom_patent}}"name" : {{ . | jsonify}},{{end}}			
			{{else if eq $s.Type "servei"}}
				{{with $s.Params.general.nom_servei}}"name" : {{ . | jsonify}},{{end}}
			{{else if eq $s.Type "spin_off"}}
				{{with $s.Params.general.nom_spinoff}}"name" : {{ . | jsonify}},{{end}}
			{{end}}

			{{with $s.Params.general.text_breu}}"text_breu" : {{. | jsonify}},{{end}}
			{{with $s.Params.general.slogan}}"eslogan" : {{. | jsonify}},{{end}}
			{{with $s.Params.general.img_background}}"imatge_url" : {{. | jsonify}},{{end}}
			{{with $s.Params.general.centre}}"centre" : {{. | jsonify}},{{end}}
			{{with $s.Params.general.sector}}"sector" : {{. | jsonify}},{{end}}
			{{with $s.Params.general.logo}}"logo_url": {{. | jsonify}},{{end}}
			
			{{with $s.Params.general.keywords}}
				{{$keywords := slice ""}}
				{{- range .}}
					{{$keywords := slice .value }}
				{{end}}
				"keywords": {{$keywords | jsonify}},
			{{end}}
			
			{{if eq $s.Type "solucio_tec"}}
				{{with $s.Params.sobre_tecnologia}}"sobre_tec_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.sobre_tecnologia}}"sobre_tec_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
			{{else if eq $s.Type "patent"}}
				{{with $s.Params.sobre_patent}} "sobre_pat_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.sobre_patent}} "sobre_pat_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
			{{else if eq $s.Type "servei"}}
				{{with $s.Params.sobre_servei}} "sobre_servei_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.sobre_servei}} "sobre_servei_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
			{{else if eq $s.Type "spin_off"}}
				{{with $s.Params.sobre_spinoff}} "sobre_spin_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.sobre_spinoff}} "sobre_spin_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
			{{end}}
			
			{{if or (eq $s.Type "solucio_tec") (eq $s.Type "pantent")}}
				{{with $s.Params.aspectes_innovadors}}"asp_innov_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.aspectes_innovadors}}"asp_innov_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
				{{with $s.Params.aplicacions}}"app_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.aplicacions}}"app_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
			{{end}}
			{{if or (eq $s.Type "servei") (eq $s.Type "spin_off")}}
				{{with $s.Params.casos_exit}}"casos_exit_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.casos_exit}}"casos_exit_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
				{{with $s.Params.casos_exit}}"casos_exit_img": {{(index . 0).img | jsonify}},{{end}}
				{{with $s.Params.casos_exit}}"casos_exit_url_success": {{(index . 0).url_success | jsonify}},{{end}}
			{{end}}
			{{if eq $s.Type "spin_off"}}
				{{with $s.Params.productes_serveis}}"productes_serveis_titol": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.productes_serveis}}"productes_serveis_descripcio": {{(index . 0).descripcio | jsonify}},{{end}}
				{{with $s.Params.clients}}"clients_title": {{(index . 0).titol | jsonify}},{{end}}
				{{with $s.Params.clients}}"clients_descripcio": {{(index . 0).titol | jsonify}},{{end}}
			{{end}}

			{{with $s.Params.grups_recerca}}
				{{$grups := slice ""}}
				{{- range .}}
					{{$grups := slice .name}}
				{{end}}
				"grups": {{$grups | jsonify}},
			{{end}}
			{{with $s.Params.investigadors}}
				{{$investigadors := slice ""}}
				{{- range .}}
					{{$investigadors := slice .name}}
				{{end}}
				"investigadors": {{$investigadors | jsonify}},
			{{end}}
			{{with $s.Params.contacte}}
				{{$nom := slice ""}}
				{{$email := slice ""}}
				{{$address := slice ""}}
				{{$phone := slice ""}}
				{{- range .}}
					{{$nom := slice .text}}
					{{$email := slice .email}}
					{{$address := slice .address}}
					{{$phone := slice .telefon}}
				{{end}}
				{{- if ne $nom nil}}"contacts_name": {{$nom | jsonify}},{{end}}
				{{- if ne $email nil}}"contacts_email": {{$email | jsonify}},{{end}}
				{{- if ne $address nil}}"contacts_address": {{$address | jsonify}},{{end}}
				{{- if ne $phone nil}}"contacts_phone": {{$phone | jsonify}},{{end}}
			{{end}}
			"content" : "transfer",
			"content_encoding" : "utf-8",
			"content_type" : {{$s.Type | jsonify}},
			"resourcename" : {{$s.Params.title | jsonify}},
			"url" : {{ $s.Permalink | jsonify }}
		}
	}{{ if ne ($.Scratch.Get "len") ($.Scratch.Get "counter")}}{{end}}{{end}}{{end}}]
